// Implementation moved to header file since it's now templated
